<div class="d-flex text-left mb-2 mt-2 justify-content-between">
    <h3>Company's Earnings</h3>
  <span>
    <span class="text-orange h4 font-weight-500">
      {{totalEarnings?.total}}
    </span>
    <small class="text-orange ml-n1">rs</small>
    <small  class="text-secondary font-weight-500 ml-1">
      Total Earning
    </small>
  </span>
</div>  
<div class="row">
  <div class="col-md-12 col-lg-12">
    <div class="card">
      <div class="card-content">
        <div class="card-body">
          <ngb-tabset type="pills" #tabset="ngbTabset">
            <ngb-tab id="tab1">
              <ng-template ngbTabTitle>
                <div class="tab-padding">
                  Total Earning
                </div>
              </ng-template>
              <ng-template ngbTabContent>
                <div class="head-earning row justify-content-center pb-3">
                  <section class="col-sm-3 text-center" *ngFor="let item of totalEarnings?.earning">
                    <p class="text-orange"><span class="h4 font-weight-500">{{item.sum}}</span> <small>rs</small> </p>
                    <img class="align-bottom" height="20px" src="{{item.src}}">
                    <span class="ml-1">{{item._id | decodeHiringType}}</span>
                  </section>
                </div>
            
                <section class="my-2 d-flex justify-content-between align-items-center">
                  <div class="d-flex">
                  <!-- this week -->
                  <span class="recent-stats pr-3">
                    <h5 class="text-orange font-weight-500 mb-0">
                      {{recentData?.currentData}}
                    </h5>
                    <small class="text-secondary font-weight-500">
                      This {{selectionType}}
                    </small>
                  </span>
                  <!-- last week -->
                  <span class="pl-3">
                    <h5 class="text-secondary font-weight-500 mb-0">
                      {{recentData?.lastData}}
                    </h5>
                    <small class="text-secondary font-weight-500">
                      Last {{selectionType}}
                    </small>
                  </span>
                  </div>
                  <ul class="d-flex status-tabs">
                    <li id="week" class="active" (click)="
                    activateTab('week');
                    getTotalEarningByWeek();
                    ">
                      By Week
                    </li>
                    <li id="month" (click)="
                    activateTab('month');
                    getTotalEarningByMonth();
                    ">
                      By Month
                    </li>
                    <li id="year" (click)="
                    activateTab('year');
                    getTotalEarningByYear();
                    ">
                      By Year
                    </li>
                  </ul>
                </section>
            
                <div class="d-block">
                  <canvas baseChart height="300"
                    [datasets]="lineChartData"
                    [labels]="lineChartLabels"
                    [options]="lineChartOptions"
                    [legend]="isLegend"
                    chartType="line">
                  </canvas>
                </div>
              </ng-template>
            </ngb-tab>
            <ngb-tab id="tab2">
              <ng-template ngbTabTitle>
                <div class="tab-padding" (click)="getEarnings()">
                  Earning Detail
                </div>
              </ng-template>
              <ng-template ngbTabContent>
                <table class="table table-responsive-md table-striped">
                    <ng-container *ngTemplateOutlet="tableHead;"></ng-container>
                    <ng-container *ngTemplateOutlet="tableBody;"></ng-container>
                </table>
                <ng-container *ngTemplateOutlet="pagination"></ng-container>
              </ng-template>
            </ngb-tab>
          </ngb-tabset>
        </div>
      </div>
    </div>
  </div>
</div>
<ng-template #tableHead let-status="status">
  <thead>
    <tr>
      <th>Hiring Type</th>
      <th>Amount</th>
      <th>Bellboy</th>
      <th>Customer</th>
      <th>Date</th>
      <th>Time</th>
    </tr>
  </thead>
</ng-template>
<ng-template #tableBody let-status="status">
  <tbody>
    <tr *ngFor="let item of earningsList">
        <td>
          <a 
          [routerLink]="[
            '/hiring/hiringDetail',
            item?.hiring?.hiring_id || 
            item?.ride?.hiring_id || 
            item?.pa?.hiring_id || 
            item?.b2b?.hiring_id
          ]" [queryParams]="{'hiringType':item.hiring_type | decodeHiringType}">{{item.hiring_type | decodeHiringType}}</a>
        </td>
        <td>{{item.amount}}rs</td>
        <td>
          <a [routerLink]="['/bellboy/bellboydetail', item.bellboy?._id]">{{item.bellboy?.name}}</a>
        </td>
        <td>
          <a [routerLink]="['/customers/custdetail', item._id]">{{item.customer?.name}}</a>
        </td>
        <td>{{item.created_at | date:'mediumDate'}}</td>
        <td>{{item.created_at| date:'mediumTime'}}</td>
    </tr>
    <ng-container *ngTemplateOutlet="shimmer"></ng-container>
  </tbody>
</ng-template>
<ng-template #pagination>
  <div class="d-flex justify-content-end px-3">
    <p class="mr-3 d-flex align-items-center"> <span class="text-shadow h6 mb-0 font-weight-normal text-orange">Total Items</span
      >
      : <span class="text-secondary ml-2">{{ pager.totalitems }}</span> 
    </p>
    <nav class="ng2-smart-pagination-nav ng-star-inserted">
      <ul class="ng2-smart-pagination pagination" *ngIf="pager.pages && pager.pages.length">
        <li class="ng2-smart-page-item page-item" [ngClass]="{ disabled: pager.currentPage === 1 }"> <a aria-label="First" class="ng2-smart-page-link page-link" (click)="setPage(1)"><span aria-hidden="true">First</span></a
          >
        </li>
        <li
          class="ng2-smart-page-item page-item"
          [ngClass]="{ disabled: pager.currentPage === 1 }"
        >
          <a
            aria-label="Prev"
            ngbTooltip="Previous 5"
            (click)="setPage(pager.currentPage-5)"
            class="ng2-smart-page-link page-link page-link-prev"
            ><span aria-hidden="true">«</span></a
          >
        </li>
        <li
          class="ng2-smart-page-item page-item ng-star-inserted"
          *ngFor="let page of pager.pages"
          [ngClass]="{ active: pager.currentPage === page }"
        >
          <a
            (click)="setPage(page)"
            class="ng2-smart-page-link page-link ng-star-inserted"
            >{{ page }}</a
          >
        </li>
        <li
          class="ng2-smart-page-item page-item"
          [ngClass]="{ disabled: pager.currentPage === pager.totalPages }"
        >
          <a
            ngbTooltip="Next 5"
            (click)="setPage(pager.currentPage+5)"
            aria-label="Next"
            class="ng2-smart-page-link page-link page-link-next"
            ><span aria-hidden="true">»</span></a
          >
        </li>
        <li
          class="ng2-smart-page-item page-item"
          [ngClass]="{ disabled: pager.currentPage === pager.totalPages }"
        >
          <a
            (click)="setPage(pager.totalPages)"
            aria-label="Last"
            class="ng2-smart-page-link page-link"
            ><span aria-hidden="true">Last</span></a
          >
        </li>
      </ul>
    </nav>
  </div>
</ng-template>
<ng-template #shimmer>
  <tr *ngIf="spinner">
    <td colspan="12">
      <div class="py-3 shine w-100"></div>
    </td>
  </tr>
</ng-template>