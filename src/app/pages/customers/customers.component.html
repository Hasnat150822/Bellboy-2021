<section id="tabs">
  <div class="row text-left mb-2 mt-2">
    <div class="col-sm-12 mb-1">
      <h3 id="id1">Manage Customers</h3>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div class="position-relative"><i ngbTooltip="Default Data" (click)="
          getCustomers('', '', apiParams.status, 1, '');
          renderClass('', '', '')
        " class="ft-refresh-cw child font-weight-bold"></i> 
        <input [type]="type" id="SearchBellboy" class="form-control placeholder-pad" #input id="input" (change)="
          placeVal == 'Cell No'
            ? (apiParams.byPhone = $event.target.value)
            : (apiParams.byName = $event.target.value)
        " placeholder="Search" (keyup)="onEnter($event)">
        <div class="btn-group position-absolute">
          <div class="btn-group" ngbDropdown role="group" aria-label="Button group with nested dropdown">
            <button class="btn border-left dropdown-toggle-split" ngbDropdownToggle>By {{ placeVal }} <i class="ft-chevron-down"></i>
            </button>
            <div class="dropdown-menu" ngbDropdownMenu>
              <button ngbDropdownItem (click)="
                placeVal = 'Name';
                type = 'text';
                apiParams.byPhone = '';
                input.value = ''
              ">Name</button>
              <button ngbDropdownItem (click)="
                placeVal = 'Cell No';
                type = 'number';
                apiParams.byName = '';
                input.value = ''
              ">Cell No</button>
            </div>
          </div>
          <button type="button" class="btn btn-search" (click)="
            getCustomers(
              apiParams.byName,
              apiParams.byPhone,
              apiParams.status,
              1,
              sortBy
            )
          ">Search</button>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-8 text-right" *ngIf="currentRole=='Super Admin'">
      <div class="btn-group">
        <select id="choice" class="btn btn-outline-secondary pr-0 choice" (change)="allSelect($event)">
          <!-- <option value="">Registered</option>
        <option value="">Unregistered</option> -->
          <option value=" ">Select Value</option>
          <option value="sendtoPakistaniUsers">Pakistanies</option>
          <!-- <option value="">All</option> -->
        </select>
        <button type="button" [disabled]="checkedValues.length == 0 && selectSenderArea == ''" class="btn btn-outline-secondary" (click)="open(sendNotification)">Send Notification</button>
      </div>
    </div>
  </div>
  <div class="row text-left">
    <!--Pills Starts-->
    <div class="col-md-12 col-lg-12">
      <div class="card">
        <div class="card-content">
          <div class="card-body">
            <div class="form-group float-right perPageBlock mb-0">
              <select class="form-control perPage" (change)="perPage = $event.target.value; getCustomers(
              apiParams.byName,
              apiParams.byPhone,
              apiParams.status,
              1,
              sortBy)">
                <option value="10">10 / page</option>
                <option value="25">25 / page</option>
                <option value="50">50 / page</option>
              </select>
            </div>
            <ngb-tabset type="pills">
              <ngb-tab>
                <ng-template ngbTabTitle>
                  <div class="tab-padding" (click)="
                    getCustomers(
                      apiParams.byName,
                      apiParams.byPhone,
                      '',
                      1,
                      sortBy
                    )
                  ">All Customers</div>
                </ng-template>
                <ng-template ngbTabContent>
                  <table class="table table-responsive-md table-striped">
                    <thead>
                      <tr>
                        <ng-container *ngTemplateOutlet="sameHeads"></ng-container>
                        <th>View</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container *ngTemplateOutlet="shimmer"></ng-container>
                      <tr @flyInOut *ngFor="let item of allcustomers">
                        <ng-container *ngTemplateOutlet="sameValue; context: item"></ng-container>
                        <td>
                          <a class="p-0 text-dark" [routerLink]="['/customers/custdetail', item._id]">
                            <img src="../../../assets/img/ico/eye.png" class="img-eye">
                          </a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <ng-container *ngTemplateOutlet="pagination"></ng-container>
                </ng-template>
              </ngb-tab>
              <ngb-tab>
                <ng-template ngbTabTitle>
                  <div class="tab-padding" (click)="
                    getCustomers(
                      apiParams.byName,
                      apiParams.byPhone,
                      'true',
                      1,
                      sortBy
                    )
                  ">Active</div>
                </ng-template>
                <ng-template ngbTabContent>
                  <table class="table table-responsive-md table-striped">
                    <thead>
                      <tr>
                        <ng-container *ngTemplateOutlet="sameHeads"></ng-container>
                        <th>Block</th>
                        <th>View</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container *ngTemplateOutlet="shimmer"></ng-container>
                      <tr @flyInOut *ngFor="let item of allcustomers">
                        <ng-container *ngTemplateOutlet="sameValue; context: item"></ng-container>
                        <td>
                          <button class="btn btn-danger" (click)="changeStatus('false', item._id)">Block</button>
                        </td>
                        <td>
                          <a class="p-0 text-dark" [routerLink]="['/customers/custdetail', item._id]">
                            <img src="../../../assets/img/ico/eye.png" class="img-eye" alt="">
                          </a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <ng-container *ngTemplateOutlet="pagination"></ng-container>
                </ng-template>
              </ngb-tab>
              <ngb-tab>
                <ng-template ngbTabTitle>
                  <div class="tab-padding" (click)="
                    getCustomers(
                      apiParams.byName,
                      apiParams.byPhone,
                      'false',
                      1,
                      sortBy
                    )
                  ">Blocked</div>
                </ng-template>
                <ng-template ngbTabContent>
                  <table class="table table-responsive-md table-striped">
                    <thead>
                      <tr>
                        <ng-container *ngTemplateOutlet="sameHeads"></ng-container>
                        <th>Unblock</th>
                        <th>View</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container *ngTemplateOutlet="shimmer"></ng-container>
                      <tr @flyInOut *ngFor="let item of allcustomers; let ind = index">
                        <ng-container *ngTemplateOutlet="sameValue; context: item"></ng-container>
                        <td>
                          <button class="btn btn-success" (click)="changeStatus('true', item._id)">Unblock</button>
                        </td>
                        <td>
                          <a class="p-0 text-dark" [routerLink]="['/customers/custdetail', item._id]">
                            <img src="../../../assets/img/ico/eye.png" class="img-eye" alt="">
                          </a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <ng-container *ngTemplateOutlet="pagination"></ng-container>
                </ng-template>
              </ngb-tab>
            </ngb-tabset>
          </div>
        </div>
      </div>
    </div>
    <!--Pills Ends-->
  </div>
</section>
<ng-template #pagination>
  <div class="d-flex justify-content-end">
    <p class="mr-3 d-flex align-items-center"><span class="text-shadow h6 mb-0 font-weight-normal text-orange">Total Items</span> : <span class="text-secondary ml-2">{{ this.count }}</span>
    </p>
    <nav class="ng2-smart-pagination-nav ng-star-inserted">
      <ul class="ng2-smart-pagination pagination" *ngIf="pager.pages && pager.pages.length">
        <li class="ng2-smart-page-item page-item" [ngClass]="{ disabled: pager.currentPage === 1 }"><a aria-label="First" class="ng2-smart-page-link page-link" (click)="
            getCustomers(
              apiParams.byName,
              apiParams.byPhone,
              apiParams.status,
              1,
              sortBy
            )
          "><span aria-hidden="true">First</span></a>
        </li>
        <li class="ng2-smart-page-item page-item" [ngClass]="{ disabled: pager.currentPage <= 4 }"><a aria-label="Prev" ngbTooltip="Previous 5" (click)="           
          getCustomers(
          apiParams.byName,
          apiParams.byPhone,
          apiParams.status,
          pager.currentPage - 5,
          sortBy
        )" class="ng2-smart-page-link page-link page-link-prev"><span aria-hidden="true">«</span></a>
        </li>
        <li class="ng2-smart-page-item page-item ng-star-inserted" *ngFor="let page of pager.pages" [ngClass]="{ active: pager.currentPage === page }"><a (click)="
            getCustomers(
              apiParams.byName,
              apiParams.byPhone,
              apiParams.status,
              page,
              sortBy
            )
          " class="ng2-smart-page-link page-link ng-star-inserted">{{ page }}</a>
        </li>
        <li class="ng2-smart-page-item page-item" [ngClass]="{ disabled: pager.currentPage >= pager.totalPages - 4 }"><a ngbTooltip="Next 5" (click)="
          getCustomers(
            apiParams.byName,
            apiParams.byPhone,
            apiParams.status,
            pager.currentPage +5,
            sortBy
          )" aria-label="Next" class="ng2-smart-page-link page-link page-link-next"><span aria-hidden="true">»</span></a>
        </li>
        <li class="ng2-smart-page-item page-item" [ngClass]="{ disabled: pager.currentPage === pager.totalPages }"><a (click)="
            getCustomers(
              apiParams.byName,
              apiParams.byPhone,
              apiParams.status,
              pager.totalPages,
              sortBy
            )
          " aria-label="Last" class="ng2-smart-page-link page-link"><span aria-hidden="true">Last</span></a>
        </li>
      </ul>
    </nav>
  </div>
</ng-template>
<ng-template #sameHeads>
  <th>
    <div class="form-group mb-0">
      <input type="checkbox" id="allSelect" class="form-control checkbox" (change)="allSelect($event)">
    </div>
  </th>
  <th><a (click)="sortByName()">Name <i id="sortByName"></i></a>
  </th>
  <th>Cell no</th>
  <th><a (click)="sortByDate()">Joining Date <i id="sortByDate"></i></a>
  </th>
  <th>Sign Up Device</th>
  <th>Current Device</th>
  <th>Last Login</th>
  <th>Last Seen</th>
  <th>Total Login</th>
  <th><a (click)="sortByNumber()">Total Hirings <i id="sortByNumber"></i></a>
  </th>
</ng-template>
<ng-template #sameValue let-id="_id" let-name="name" let-mobile="mobile" let-created_at="created_at" let-signup_device="signup_device" let-current_device="current_device" let-last_active="last_active" let-total_logins="total_logins" let-total_hirings="total_hirings"
let-checked="checked" let-last_seen="last_seen">
  <td>
    <div class="form-group mb-0">
      <input type="checkbox" (change)="selectCustomers($event)" [checked]="checked" value="{{ id }}" class="form-control checkbox">
    </div>
  </td>
  <td>{{ name ? name : "-" }}</td>
  <td>{{ mobile ? mobile : "-" }}</td>
  <td>{{ created_at | date: "mediumDate" | showDashes }}</td>
  <td><span>{{ signup_device | deviceCode }}</span>
  </td>
  <td><span>{{ current_device | deviceCode }}</span>
  </td>
  <td>{{ last_active | date: "mediumDate" }}</td>
  <td>{{ last_seen | date: "mediumDate" | showDashes }}</td>
  <td>{{ total_logins }}</td>
  <td>{{ total_hirings }}</td>
</ng-template>
<ng-template #shimmer>
  <tr *ngIf="spinner">
    <td colspan="12">
      <div class="py-3 shine w-100"></div>
    </td>
  </tr>
</ng-template>
<ng-template #sendNotification let-modal>
  <div class="modal-header justify-content-center mb-1">
    <h3 class="card-title mb-0">Add Notification</h3><a (click)="modal.close('Cancel Modal')"><i class="ft-x close-icon"></i></a>
  </div>
  <div class="modal-body">
    <form [formGroup]="notificationForm" class="row">
      <div class="form-group text-center col-sm-12">
        <div class="position-relative">
          <input accept="image/*" #file type="file" accept="image/*" (change)="preview(file.files)" class="upload-input" type="file">
          <button class="camera-icon btn btn-orange">Add Image</button>
          <img class="upload-image" id="img1" onerror="src='../../../assets/img/ico/bb-brand.jpg'" src="{{ imgURL }}">
          <p class="text-error mb-0" *ngIf="message">{{ message }}</p>
        </div>
      </div>
      <div class="form-group col-12">
        <input type="text" class="form-control" placeholder="Title" formControlName="title">
        <p class="text-danger" *ngIf="title.errors?.required && title.touched">Title is required</p>
      </div>
      <div class="form-group col-12">
        <input type="text" class="form-control" placeholder="Description" formControlName="description" maxlength="250">
        <p class="text-danger" *ngIf="description.errors?.required && description.touched">Description is required</p>
        <p class="text-danger" *ngIf="description.error?.maxLength && description.touched">Maximum 250 character required</p>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-orange" [disabled]="!notificationForm.valid" (click)="submitNotification()">Send Notification</button>
  </div>
</ng-template>